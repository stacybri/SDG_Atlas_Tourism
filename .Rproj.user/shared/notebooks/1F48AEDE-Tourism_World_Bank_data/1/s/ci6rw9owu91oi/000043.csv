"0","# ggplot(tour_avg_df, aes(x=tourism, y=change_gdp)) +"
"0","#   geom_col(fill='#ef233c') +"
"0","#   ylab('Change in GDP 2019-2021') +"
"0","#   xlab('Tourism as share of GDP') + "
"0","#   expand_limits(y=c(-10,2)) +"
"0","#   labs(title=str_wrap('Economies dependent on tourism saw large drops in GDP from 2019-21',60),"
"0","#        caption='Data on tourism expenditure from UNWTO.  Data on GDP from World Bank.') +"
"0","#   theme_bw(  ) "
"0","#   "
"0","#plot the data"
"0","# Assuming you have the necessary data in the 'tour_rel_df' dataframe"
"0","# Assuming you have the necessary data in the 'tour_rel_df' dataframe"
"0","tour_rel_df <- tour_rel_df %>%"
"0","  mutate(across(c('tourism_gdp_share_2019', 'change_gdp'), round, 2)) %>%"
"0","  arrange(tourism_gdp_share_2019)"
"0",""
"0","# Calculate linear regression coefficients"
"0","gdp_model <- loess(change_gdp ~ tourism_gdp_share_2019, data = tour_rel_df, degree=1)"
"0",""
"0",""
"0",""
"0","# Calculate regression line points"
"0","x_values <- tour_rel_df$tourism_gdp_share_2019"
"0","y_values <- predict(gdp_model)"
"0","regression_data <- data.frame(tourism_gdp_share_2019 = x_values, change_gdp = y_values)"
"0",""
"0",""
"0","# Create a series for the regression line"
"0","regression_series <- list("
"0","  type = ""line"","
"0","  name = ""Regression Line"","
"0","  data = regression_data,"
"0","  #marker = list(enabled = FALSE),"
"0","  color = ""red"",  # Set line color"
"0","  lineWidth = 2    # Set line width"
"0",")"
"0",""
"0","legend_options <- list("
"0","  enabled = TRUE,                   # Enable the legend"
"0","  align = ""center"",                 # Set the legend's horizontal alignment"
"0","  layout = ""vertical"",              # Set the legend's layout (vertical or horizontal)"
"0","  verticalAlign = ""top"",            # Set the legend's vertical alignment"
"0","  itemStyle = list(fontWeight = ""bold"")  # Customize the legend item's style"
"0",")"
"0",""
"0","# Create a Highcharter plot"
"0","hchart("
"0","  tour_rel_df,"
"0","  type='scatter',"
"0","  hcaes("
"0","      x = tourism_gdp_share_2019,"
"0","      y = change_gdp,"
"0","      color=tourism,"
"0","      name=country,"
"0","      tooltip=list("
"0","        pointFormat = ""<b>{point.name}</b><br> Tourism as share of GDP: {point.x}<br> Percentage Change in GDP 2019-21: {point.y}%"""
"0","      )"
"0","  )"
"0","  ) %>%"
"0","  hc_tooltip("
"0","    split = TRUE,"
"0","    pointFormat = ""<b>{point.name}</b><br> Tourism as share of GDP: {point.x}<br> Percentage Change in GDP 2019-21: {point.y}%"""
"0","  )  %>%"
"0","  hc_add_series(  "
"0","    regression_data,"
"0","    type = ""line"","
"0","    hcaes("
"0","      x = tourism_gdp_share_2019,"
"0","      y = change_gdp),"
"0","    color='red',"
"0","    enableMouseTracking=FALSE"
"0","    "
"0","    ) %>%"
"0","  hc_xAxis("
"0","    title = list(text = ""Tourism as share of GDP""),"
"0","    gridLineWidth = 1,"
"0","    type='logarithmic'"
"0","  ) %>%"
"0","  hc_yAxis("
"0","    title = list(text = ""Percentage Change in GDP 2019-21""),"
"0","    gridLineWidth = 1"
"0","  ) %>%"
"0","  hc_title("
"0","    text = ""Economies dependent on tourism saw large drops in GDP from 2019-21"","
"0","    align = ""center"","
"0","    margin = 20"
"0","  ) %>%"
"0","  hc_subtitle("
"0","    text = ""Data on tourism expenditure from UNWTO. Data on GDP from World Bank."","
"0","    align = ""center"","
"0","    margin = 10"
"0","  ) %>%"
"0","  hc_caption("
"0","    text=""Fitted line produced using local 1st degree polynomial regression fitting."""
"0","  ) %>%"
"0","  hc_legend(legend_options)  "

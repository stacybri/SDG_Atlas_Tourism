"0","#| label: data"
"0",""
"0","# read in data on which economies are tourism dependent"
"0","## Tourism data"
"0","#use tourism data from UNWTO"
"0",""
"0",""
"0","gdp_forcast_df <- read_csv(paste0(dir, ""/Data/chart3_GDP_COVID_country.csv""))"
"2","[1mRows: [22m[34m2391[39m [1mColumns: [22m[34m11[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[31mchr[39m (4): country, iso3c, gap_dollars, gap_relative
[32mdbl[39m (7): date, gdp_grwth, gdp, gdp_for20_grwth, gdp_forc20, gdp_dollars, gdp_forc20_dollars"
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","#use tourism data from UNWTO"
"0","#read in iso3c codes to match to UN database"
"0","iso_codes <- read_csv(paste0(dir, ""/Data/iso_codes.csv"")) %>%"
"0","  rename(GeoAreaCode=geoAreaCode)"
"2","[1mRows: [22m[34m249[39m [1mColumns: [22m[34m3[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[31mchr[39m (2): country, iso3c
[32mdbl[39m (1): geoAreaCode"
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","#data from https://www.unwto.org/statistic/basic-tourism-statistics"
"0","tourism_df <- read_excel(path=paste0(dir, '/Data/unwto-inbound-expenditure-data.xlsx'), skip=2) %>%"
"0","  rename(GeoAreaCode=C.,"
"0","         indicator=...5) %>% "
"0","  filter(!is.na(indicator)) %>%"
"0","  pivot_longer("
"0","    cols=c(12:36),"
"0","    names_to='date',"
"0","    values_to='expenditure'"
"0","  ) %>%"
"0","  left_join(iso_codes) %>%"
"0","  transmute(iso3c=iso3c,"
"0","            date=as.numeric(date),"
"0","            expenditure=1000000*as.numeric(expenditure) #convert expenditure from per million to per dollar"
"0","            )"
"2","New names:"
"2","Joining with `by = join_by(GeoAreaCode)`"
"2","Warning: [38;5;255mThere was 1 warning in `transmute()`.[39m
[38;5;255m[36mâ„¹[38;5;255m In argument: `expenditure = 1e+06 * as.numeric(expenditure)`.[39m
Caused by warning:
[33m![39m NAs introduced by coercion"
"0","#get GDP data from WDI"
"0","wdi_join <- wb_data("
"0","  indicator=c('NY.GDP.MKTP.KD','SP.POP.TOTL', 'AG.LND.EL5M.ZS'),"
"0","  start_date=1995,"
"0","  end_date=2019"
"0",")"
"0",""
"0","country_data <- wb_countries()"
"0",""
"0","#join with gdp data"
"0","tourism_df <- tourism_df %>%"
"0","  left_join(wdi_join) %>%"
"0","  mutate(tourism_gdp_share=100*expenditure/NY.GDP.MKTP.KD)"
"2","Joining with `by = join_by(iso3c, date)`"
"0","#now look at this relationhsip in context of vulnerable employment"
"0",""
"0","tour_rel_df <- gdp_forcast_df %>%"
"0","  left_join(tourism_df) %>%"
"0","  select(-country, -iso2c) %>%"
"0","  left_join(country_data) %>%"
"0","  group_by(iso3c) %>%"
"0","  fill(tourism_gdp_share) %>%"
"0","  filter(!is.na(tourism_gdp_share)) %>%"
"0","  mutate(tourism=case_when("
"0","           tourism_gdp_share>10 ~ "">= 10% GDP"", "
"0","           between(tourism_gdp_share,5,10) ~ ""5-10% GDP"","
"0","           tourism_gdp_share<5 ~ ""< 5% GDP"", "
"0","                   )) %>%"
"0","  filter(date==2019 | date==2020 | date==2021) %>%"
"0","  pivot_wider("
"0","    id_cols=c('country','iso3c', 'region'),"
"0","    values_from=c('gdp','SP.POP.TOTL','tourism_gdp_share', 'tourism'),"
"0","    names_from=date,"
"0","    names_glue = ""{.value}_{date}"""
"0","  ) %>%"
"0","  mutate(change_gdp=100*(gdp_2021-gdp_2019)/gdp_2019) %>%"
"0","  mutate(tourism=case_when("
"0","    !is.na(tourism_2019) ~ tourism_2019,"
"0","    !is.na(tourism_2020) ~ tourism_2020,"
"0","    !is.na(tourism_2021) ~ tourism_2021,"
"0","  ))"
"2","Joining with `by = join_by(country, iso3c, date)`"
"2","Joining with `by = join_by(iso3c)`"
